<div class="scan-history-section">
  <h2 class="scan-history-title">ðŸ•“ Scan History</h2>
  @if (scanHistory.length === 0) {
    <div class="flex flex-col items-center justify-center">
      <span class="scan-history-icon">
        <!-- SVG icon here -->
      </span>
      <p class="scan-history-empty">No previous scans found</p>
      <small class="scan-history-description">Your scan history will appear here</small>
    </div>
  } @else {
    <ul class="scan-history-list">
      @for (item of scanHistory; track item) {
        <li class="scan-history-item">
          <div class="scan-header">
            <div class="scan-url">
              <strong>{{ item.result?.url || item.url }}</strong>
              <span class="scan-time">({{ item.result?.scan_time ? (item.result.scan_time | date:'medium') : (item.time | date:'medium') }})</span>
            </div>
            <div class="scan-risk-level">
              <b>Risk Level:</b> {{ item.result?.risk_level || 'N/A' }}
            </div>
            <div class="scan-most-common-owasp" *ngIf="item.result?.most_common_owasp">
              <b>Most Common OWASP:</b> {{ item.result.most_common_owasp }}
            </div>
            <div class="scan-alerts">
              <b>Alerts:</b> {{ item.result?.alerts?.length || 0 }}
            </div>
            <!-- ML Result removed -->
          </div>
          <div class="scan-section-details" *ngIf="item.result?.alerts && item.result.alerts.length">
            <h4 class="scan-section-title">Alerts Detail</h4>
            <ul class="alert-list">
              <li *ngFor="let alert of item.result.alerts" [ngClass]="{'alert-high': alert.risk && alert.risk.toLowerCase() === 'high'}">
                <ng-container *ngIf="alert.name">
                  <b>{{ alert.name }}</b> - {{ alert.risk }}<br>
                  <span *ngIf="alert.description">{{ alert.description }}</span>
                </ng-container>
                <ng-container *ngIf="!alert.name">
                  {{ alert | json }}
                </ng-container>
              </li>
            </ul>
          </div>
          <!-- Spider Data and Active Scan Data removed -->
          <!-- All Alerts from ES removed -->
          <div class="scan-section-details" *ngIf="item.error">
            <div class="error-message">{{ item.error }}</div>
          </div>
        </li>
      }
    </ul>
  }
</div>
